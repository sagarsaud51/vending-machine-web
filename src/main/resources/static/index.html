<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <title>Hello, world!</title>
</head>
<body>

<div class="container">

    <div class="row">

        <div class="col-md-6">
            <h1 class="display-6 text-center" id="vending-name"></h1>
            <div class="row mt-lg-5 justify-content-center" id="item-body">

            </div>

        </div>
        <div class="col-md-6">
            <div class="row mt-lg-5 justify-content-center">
                <div class="jumbotron">
                    <h4 class="display-6">Hello, world!</h4>
                    <p class="lead"></p>
                    <hr class="my-4">
                    <div class="btn-group-vertical ml-4 mt-4" role="group" aria-label="Basic example">
                        <div class="btn-group">
                            <input class="text-center form-control-lg mb-2" id="code" disabled>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '1';">
                                1
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '2';">
                                2
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '3';">
                                3
                            </button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '4';">
                                4
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '5';">
                                5
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '6';">
                                6
                            </button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '7';">
                                7
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '8';">
                                8
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '9';">
                                9
                            </button>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-danger py-3" onclick="cancel()">
                                Cancel
                            </button>
                            <button type="button" class="btn btn-outline-secondary py-3"
                                    onclick="document.getElementById('code').value=document.getElementById('code').value + '0';">
                                0
                            </button>
                            <button type="button" class="btn btn-primary py-3" onclick="placeOrder($('#code').val())">
                                Order
                            </button>
                        </div>
                        <p class="lead">Add Cash</p>
                        <div class="btn-toolbar mb-3" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="btn-group me-2" role="group" aria-label="First group">
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(10)">
                                    10
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(20)">
                                    20
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(50)">
                                    50
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(100)">
                                    100
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(500)">
                                    500
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCash(1000)">
                                    1000
                                </button>
                            </div>
                        </div>
                        <p class="lead">Add Coin</p>
                        <div class="btn-toolbar mb-3" role="toolbar" aria-label="Toolbar with button groups">
                            <div class="btn-group me-2" role="group" aria-label="First group">
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCoins(1)">1
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCoins(2)">2
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCoins(5)">5
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCoins(10)">
                                    10
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="addCoins(25)">
                                    25
                                </button>
                            </div>
                        </div>
<!--                        <div class="btn-toolbar mb-3" role="toolbar" aria-label="Toolbar with button groups">-->
<!--                            <button type="button" class="btn btn-danger" onclick="cancel()">Cancel</button>-->
<!--                        </div>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: Bootstrap Bundle with Popper -->


<!-- Option 2: Separate Popper and Bootstrap JS -->
<!--
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
-->
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
<style>
    .card-custom {
        max-width: max-content;
    }

</style>


<script type="application/javascript">
    //on init fetch the data from the server
    // const baseUrl = "http://localhost:8080/";
    var baseUrl;

    $(document).ready(function () {
        baseUrl = window.location.origin + '/';
        console.log(baseUrl);
        getInfo();
        fetchAllItems();
    });

    function getInfo() {
        $.ajax({
            url: baseUrl + 'api/v1/cool/info',
            type: 'GET',
            success: function (data) {
                console.log(data);
                $('#vending-name').text(data.object);
                $.each(data, function (index, value) {
                    // $('#products').append('<tr><td>' + value.id + '</td><td>' + value.name + '</td><td>' + value.price + '</td><td>' + value.quantity + '</td></tr>');
                });
            }
        });
    }


    function placeOrder(data) {
        console.log(data);
        console.log(data.length);
        if (data.length !== 0) {
            $.ajax({
                url: baseUrl + 'api/v1/cool/order',
                type: 'POST',
                contentType: "application/json",
                data: JSON.stringify({orderId: data}),
                success: function (data) {
                    console.log(data);
                    fetchAllItems();
                }
            });
        }
    }


    function addCash(data) {
        $.ajax({
            url: baseUrl + 'api/v1/cool/load-cash',
            type: 'POST',
            contentType: "application/json",
            data: JSON.stringify({amount: data}),
            success: function (data) {
                console.log(data);
            }
        });
    }

    function addCoins(data) {
        $.ajax({
            url: baseUrl + 'api/v1/cool/load-cash',
            type: 'POST',
            contentType: "application/json",
            data: JSON.stringify({amount: data}),
            success: function (data) {
                console.log(data);
            }
        });
    }

    function cancel(){
        $.ajax({
            url: baseUrl + 'api/v1/cool/cancel',
            type: 'GET',
            success: function (data) {
                console.log(data);
            }
        });
    }

    function fetchAllItems() {
        $('#item-body').empty();
        $.ajax({
            url: baseUrl + 'api/v1/cool/all-items',
            type: 'GET',
            success: function (data) {
                console.log(data);
                $.each(data, function (index, value) {
                    $('#item-body').append(
                        `
                         <div class="card card-custom mx-2 mb-3">
                            <img src="https://via.placeholder.com/150" class="card-img-top" alt="...">
                                <div class="card-body">
                                    <p class="card-text">Name: ${value.name}(${value.stock})<br>Code: ${value.code} <br> price: ${value.amount}</p>
                                </div>
                         </div>
                        `
                    );
                    // $('#name'+index).append( value.name);
                    // $('#price'+index).append( value.amount);
                    // $('#stock'+index).append( value.stock);
                });
            }
        });
    }
</script>
</html>